<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualize Data - Earthquake Sequence Mining</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.css">
    <style>
        .chart-container {
            height: 280px;
            margin-bottom: 1rem;
        }
        .sidebar-section {
            height: calc(100vh - 120px);
            overflow-y: auto;
        }
        .main-section {
            height: calc(100vh - 120px);
            overflow-y: auto;
        }
    </style>
</head>
<body class="py-3">
    <nav class="navbar navbar-dark bg-transparent">
        <div class="container">
            <a class="navbar-brand text-white fw-bold" href="index.html">
                <i class="bi bi-house-door-fill"></i> Home
            </a>
        </div>
    </nav>

    <div class="container-fluid px-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row g-3">
                    <!-- Column 1: Controls & Charts -->
                    <div class="col-lg-4 sidebar-section">
                        <!-- Year Selector -->
                        <div class="mb-3">
                            <label class="form-label small fw-bold mb-1">Select Year:</label>
                            <select id="yearSelect" class="form-select" disabled>
                                <option value="" disabled selected>-- Loading years --</option>
                            </select>
                        </div>

                        <!-- Charts -->
                        <div id="chartsSection" style="display:none;">
                            <!-- Magnitude Distribution -->
                            <div class="card mb-2">
                                <div class="card-body p-2">
                                    <h6 class="card-title small mb-2">Magnitude Distribution</h6>
                                    <div id="magChart" class="chart-container"></div>
                                </div>
                            </div>

                            <!-- Depth Distribution -->
                            <div class="card mb-2">
                                <div class="card-body p-2">
                                    <h6 class="card-title small mb-2">Depth Distribution</h6>
                                    <div id="depthChart" class="chart-container"></div>
                                </div>
                            </div>

                            <!-- Monthly Distribution -->
                            <div class="card mb-2">
                                <div class="card-body p-2">
                                    <h6 class="card-title small mb-2">Monthly Distribution</h6>
                                    <div id="monthChart" class="chart-container"></div>
                                </div>
                            </div>

                            <!-- Quick Stats -->
                            <div class="card mb-2">
                                <div class="card-body p-2">
                                    <h6 class="card-title small mb-2">Quick Stats</h6>
                                    <div class="row g-2 text-center">
                                        <div class="col-6">
                                            <div class="small text-muted">Total Events</div>
                                            <div class="fs-5 fw-bold text-primary" id="statCount">-</div>
                                        </div>
                                        <div class="col-6">
                                            <div class="small text-muted">Avg Magnitude</div>
                                            <div class="fs-5 fw-bold text-success" id="statAvgMag">-</div>
                                        </div>
                                        <div class="col-6">
                                            <div class="small text-muted">Max Magnitude</div>
                                            <div class="fs-5 fw-bold text-danger" id="statMaxMag">-</div>
                                        </div>
                                        <div class="col-6">
                                            <div class="small text-muted">Avg Depth</div>
                                            <div class="fs-5 fw-bold text-info" id="statAvgDepth">-</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Placeholder when no year selected -->
                        <div id="placeholderMsg" class="text-center text-muted py-4">
                            <i class="bi bi-calendar-x display-4 mb-2"></i>
                            <p class="mb-0">Please select a year to view data</p>
                        </div>
                    </div>

                    <!-- Column 2: DataTable -->
                    <div class="col-lg-8 main-section">
                        <div class="table-responsive">
                            <table id="dataTable" class="table table-striped table-hover table-sm" style="display:none;">
                                <thead class="table-dark position-sticky top-0">
                                    <tr>
                                        <th>#</th>
                                        <th>Time</th>
                                        <th>Location</th>
                                        <th>Magnitude</th>
                                        <th>Depth (km)</th>
                                        <th>Latitude</th>
                                        <th>Longitude</th>
                                    </tr>
                                </thead>
                                <tbody id="tableBody"></tbody>
                            </table>
                            <div id="tablePlaceholder" class="text-center text-muted py-5">
                                <i class="bi bi-hand-index-thumb display-4 mb-2"></i>
                                <p class="mb-0">Please select a year to view data table</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" style="display:none;">
        <div class="loadingContent">
            <div id="loadingIcon" class="loadingSpinner" style="display:none;"></div>
            <i id="loadingSpinner" class="bi bi-arrow-repeat spin-border" style="display:none; font-size: 2rem;"></i>
            <i id="successIcon" class="bi bi-check-circle-fill" style="display:none; font-size: 2rem; color: #198754;"></i>
            <i id="errorIcon" class="bi bi-x-circle-fill" style="display:none; font-size: 2rem; color: #dc3545;"></i>
            <h5 class="mt-3 mb-2" id="loadingTitle">Connecting to API...</h5>
            <p class="text-muted mb-3" id="loadingMessage">Please wait</p>
            <div id="okButtons" class="mt-3">
                <button type="button" class="btn btn-primary" id="loadingModalOk">OK</button>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
    <script src="js/visualize.js"></script>
</body>
</html>
